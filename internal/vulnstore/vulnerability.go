package vulnstore

import (
	"github.com/quay/claircore"
)

// GetOpts provides instructions on how to
// match your packages to vulnerabilities.
type GetOpts struct {
	// Matchers tells the Get() method to limit the returned vulnerabilities by the provided MatchExps.
	// see MatchExp type def for more info.
	Matchers []MatchExp
}

type Vulnerability interface {
	// get finds the vulnerabilities which match each package provided in the packages array
	// this maybe a one to many relationship. each package is assumed to have an ID.
	// a map of Package.ID => Vulnerabilities is returned.
	Get(packages []*claircore.Package, opts GetOpts) (map[int][]*claircore.Vulnerability, error)
}
